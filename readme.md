# SlotModuleMk2.5
## パチスロを作ろう(雑なチュートリアル)
### 1.はじめに
このテンプレートは、4号機ノーマル(ボーナスのみで出玉を増やす台)です。  
絵柄、配列、制御、演出、予告音などを組み合わせて、オリジナルのパチスロを作ってみましょう。  

### 2.絵柄
絵柄はimg/reelchip.pngに、並べた１つの画像として定義します。  
透過を行うと、きれいに表示されます。
各絵柄のサンプルをimg\chipImagesに保管しています。参考にどうぞ

### 3.配列
同封のRCTMaker(SlotModule's Pageさんで配布されていたが、現在はサイトが閉鎖されている。ただし、再配布可能なので同封します。)を使用します。  
src/datas/RCD/control.rcdを開き、編集しましょう。
  
初めての台は、配列はイメージに合った台の配列をパクるのがおすすめです。
１から作る場合、同時入賞してしまうような配置をできるだけ避けましょう。  
そうしないと、岡崎産業のコアのように攻略打法が発覚するかもしれません。

### 4.制御
成立役に対する制御を設定します。  
「ツール→テーブルチェッカー」で、理不尽な小役こぼしが(せめて順押しのときぐらいは)ない、やさしい制御がいいですね。  
変則押しをするときには、成立ラインを絞るとそれっぽくなります。  
小役やボーナスは、複数制御を設定すると深みが出ます。自分だけのこだわりを見つけましょう。  
完成した制御は、「実行->SlotModule用の...」で、src/datas/RCD/control.smrに出力しましょう。

### 5.制御データとコードの紐付け
src/datas/Control.jsを編集します。
RCTMakerの制御ルールと同じ順番になるように、code:[...]を編集します。  
名前は一致しなくても構いません。

### 6.構成役データの紐付けと払い出し枚数の定義
src/datas/Yaku.jsを編集します。
サンプルを参考に、構成役をコードに落とし込みます。  
同時に、払い出し枚数の定義も行います。


### 7.確率
src/datas/Lot.jsを編集し、小役の確率を決定しましょう。  
特に言うことはないです。

### 8.制御振り分け
src/System.jsを編集します。  
slotModule.onLotの内容を編集し、抽選結果と制御を振り分けます。  
ボーナス成立時の5%の制御など、レア制御を決めてやると楽しいかもしれませんね。  


### 9.成立役の処理
slotModule.onHitCheckの内容を編集します。  
主にリプレイとBIG,REG成立時の処理を記述します。

### 10.音
src/Sound.jsを編集します。  
サンプルを参考に、ファイル指定とタグ付けを行います。  
sounder.playSoundで、好きなタイミングで鳴らすことができますよ。

### 11.演出
src/Effect.jsを編集します。  
SyotoEffectに、簡単な消灯と予告音の処理を記述します。
サンプルがあるので、確率をいじるだけでもオリジナリティが出ますね。  
私はサンダーV2を思い出しました。

## 便利関数
### Sleep(ms)
 - msミリ秒停止します。async関数なのでawaitと一緒に使おうね
 - 例(払い出し後、3秒フリーズ)
```javascript
slotModule.once('payEnd',async ()=>{
    slotModule.freeze();
    await Sleep(3000); // 3秒待ちます
    slotModule.resume();
})
```

### ArrayLot([v1,v2,v3,...])
 - v1+v2+v3+..個のくじを引き、当選したインデックスを返します。
 - 振り分け作るときに便利
 - 例(制御振り分け)
```javascript
ret = ['BIG1','BIG2','BIG3'][ArrayLot([60,30,10])];
/**  
 *  BIG1 60%
 *  BIG2 30%
 *  BIG3 10%
 *   で制御を振り分ける。
 **/
```

### ContinueLot(r)
 - 確率rで継続抽選を行う。
 - 1とか引数にするとぶっ壊れるからやめようね
 - 例(50%のループストック抽選)
```javascript
stock++; // 最低保証
stock += ContinueLot(1/2); // 50%ループ
```

### Rand(m, n = 0)
 - n ~ (n + m-1)までの整数乱数を発生させる。
 - Rand(4)のように書くと、0~3までの乱数を返す
 - !0がtrueになることを利用し、簡易的な抽選にも使用できる
 - 例(1/3で特殊演出を発生させる)

```javascript
if(!rand(3)){
 // 特殊演出を書く
}
```

### ReplaceMatrix(base, matrix, front, back)
 - baseのフラッシュの、matrixが示す箇所に、flashとbackを適用させる。
 - 成立役フラッシュ用の関数なので、直接使う機会はないかも